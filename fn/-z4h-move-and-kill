local -i cursor=CURSOR backkill=0
local cutbuffer
"$@"
emulate -L zsh
if (( CURSOR > cursor )); then
  cutbuffer=$BUFFER[cursor+1,CURSOR]
  BUFFER[cursor+1,CURSOR]=
  CURSOR=$cursor
elif (( CURSOR < cursor )); then
  cutbuffer=$BUFFER[CURSOR+1,cursor]
  backkill=1
  BUFFER[CURSOR+1,cursor]=
fi
if [[ "$LASTWIDGET" =~ 'kill-' ]]; then
  if (( backkill )); then
    CUTBUFFER=$cutbuffer$CUTBUFFER
  else
    CUTBUFFER+=$cutbuffer
  fi
else
  zle copy-region-as-kill "$cutbuffer"
fi
zle -f kill
